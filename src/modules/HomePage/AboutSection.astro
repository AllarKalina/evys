---
import AboutItem from "./AboutItem";
import Mission from "./Mission";

const aboutUsResponse = await fetch(
  "https://evys-api-production.up.railway.app/graphql",
  {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      query: `
      query {
        aboutUsImages {
          data {
            attributes {
              image {
                data {
                  attributes {
                    url
                  }
                }
              }
              location
            }
          }
        }
      }
    `,
    }),
  }
);

const json = await aboutUsResponse.json();
const data = json.data.aboutUsImages.data;

const smallLandscapeImage = data.find(
  (item: any) => item.attributes.location === "small_landscape"
);

const largeLandscapeImage = data.find(
  (item: any) => item.attributes.location === "large_landscape"
);

const portraitImage = data.find(
  (item: any) => item.attributes.location === "portrait"
);
---

<main
  class="mx-auto grid max-w-screen-xl grid-cols-1 overflow-visible px-4 md:px-8 lg:grid-cols-5 lg:gap-16"
>
  {/* Left column */}
  <section class="z-10 col-span-1 max-w-lg lg:col-span-2">
    <header class="sticky top-36">
      <Mission
        client:visible
        color="cyan"
        subTitle="Kes me oleme"
        header="Toredad tudengid ja meeldejäävad elamused"
        text="Eesti Veterinaarmeditsiini Üliõpilaste Selts (EVÜS) asutati Tartus 2013. aastal, et ühendada enda alla veterinaarmeditsiini õppivad Eesti tudengid."
      />
    </header>
  </section>
  {/* Right column */}
  <div
    class="pointer-events-none absolute top-0 left-0 h-full w-1/2 overflow-hidden"
  >
    <figure
      class="pointer-events-none absolute top-16 left-24 hidden h-[400px] w-[360px] origin-top-left rotate-12 xl:block"
    >
      <div class="aspect-w-4 aspect-h-5">
        <div
          class="absolute top-0 left-[-200%] -right-1/4 h-px opacity-30"
          style="background-image:linear-gradient(to right, rgba(148, 163, 184, 0) 33%, rgb(148, 163, 184) 80%, rgba(148, 163, 184, 0) 100%)"
        >
        </div>
        <div
          class="absolute top-[-125%] right-0 -bottom-1/3 w-px opacity-30"
          style="background-image:radial-gradient(closest-corner at 50% 66%, rgb(148, 163, 184), rgba(148, 163, 184, 0))"
        >
        </div>
        <div
          class="absolute bottom-0 left-[-200%] -right-1/2 h-px opacity-30"
          style="background-image:linear-gradient(to right, rgba(148, 163, 184, 0) 33%, rgb(148, 163, 184) 80%, rgba(148, 163, 184, 0) 100%)"
        >
        </div>
        <div
          class="absolute top-[-100%] left-0 -bottom-1/2 w-px opacity-30"
          style="background-image:radial-gradient(closest-corner at 50% 66%, rgb(148, 163, 184), rgba(148, 163, 184, 0))"
        >
        </div>
        <div
          class="absolute top-[-0.5px] left-0 h-[2px] w-28 -translate-x-1/3 rounded-full bg-gradient-to-r from-cyan-600"
        >
        </div>
        <div
          class="absolute bottom-[-0.5px] right-0 h-[2px] w-28 translate-x-4 rounded-full bg-gradient-to-l from-rose-400"
        >
        </div>
      </div>
    </figure>
  </div>
  <section
    class="relative col-span-1 overflow-hidden pt-12 lg:col-span-3 lg:pt-60"
  >
    <ul role="list" class="flex flex-col gap-12 pt-8">
      <AboutItem
        href="/info"
        client:visible
        color="cyan"
        header="Seltsist"
        buttonText="Loe seltsist"
        description="Eesti Veterinaarmeditsiini Üliõpilaste Selts (EVÜS) asutati Tartus 2013. aastal, et ühendada enda alla veterinaarmeditsiini õppivad Eesti tudengid. Seltsisiseselt korraldatakse erialaseid loenguid, õpitubasid ja väljasõite ning vabaajaüritusi, et tuua erinevate kursuste üliõpilased teineteisele lähemale."
        imageUrl={portraitImage.attributes.image.data.attributes.url}
      />
      <AboutItem
        href="/info/teams"
        client:visible
        color="green"
        header="Juhatus ja meeskonnad"
        buttonText="Tutvu meeskondadega"
        description="Eesti Veterinaarmeditsiini Üliõpilaste Selts (EVÜS) asutati Tartus 2013. aastal, et ühendada enda alla veterinaarmeditsiini õppivad Eesti tudengid. Seltsisiseselt korraldatakse erialaseid loenguid, õpitubasid ja väljasõite ning vabaajaüritusi, et tuua erinevate kursuste üliõpilased teineteisele lähemale."
        imageUrl={smallLandscapeImage.attributes.image.data.attributes.url}
      />
      <AboutItem
        href="/info/documents"
        client:visible
        color="rose"
        header="Dokumendid"
        buttonText="Vaata dokumente"
        description="Eesti Veterinaarmeditsiini Üliõpilaste Selts (EVÜS) asutati Tartus 2013. aastal, et ühendada enda alla veterinaarmeditsiini õppivad Eesti tudengid. Seltsisiseselt korraldatakse erialaseid loenguid, õpitubasid ja väljasõite ning vabaajaüritusi, et tuua erinevate kursuste üliõpilased teineteisele lähemale."
        imageUrl={largeLandscapeImage.attributes.image.data.attributes.url}
      />
    </ul>
  </section>
</main>
