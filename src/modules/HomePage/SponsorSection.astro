---
import SponsorItem from "./components/SponsorItem";

const sponsorResponse = await fetch(
  "https://evys-api-production.up.railway.app/graphql",
  {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      query: `
        query {
          sponsors {
            data {
              attributes {
                logo {
                  data {
                    attributes {
                      url
                    }
                  }
                }
              }
            }
          }
        }
      `,
    }),
  }
);

const json2 = await sponsorResponse.json();
const data2 = json2.data.sponsors.data;
---

<main
  class="relative z-20 w-full border-y border-cyan-600 bg-gradient-to-r from-emerald-600 to-cyan-700 shadow-lg shadow-cyan-700/30"
>
  <section class="mx-auto max-w-lg py-20 px-4 xl:py-24">
    <header class="flex flex-col items-center justify-center gap-4">
      <h6 class="text-lg font-bold tracking-wide text-white lg:text-xl">
        Meid toetavad
      </h6>
      <figure class="h-[3px] w-24 rounded-full bg-white"></figure>
    </header>
    <ul
      class="mt-8 grid grid-rows-2 gap-4 lg:grid-cols-2 lg:grid-rows-1 lg:gap-8"
    >
      {
        data2.map((sponsor: any) => {
          return (
            <SponsorItem
              client:visible
              imageUrl={sponsor.attributes.logo.data.attributes.url}
            />
          );
        })
      }
    </ul>
  </section>
</main>
